"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[8279],{20418:(e,t,s)=>{s.d(t,{Ie:()=>i,Qd:()=>a});var o=s(31085),n=s(14041),r=s(79824);const i=function(){const e=(0,n.createContext)({});return e.displayName="XboxSocialClient",e}();function a(e,t){const s=(0,n.createContext)({});return s.displayName="XboxSocialClientRedux",function(n){let{children:a,context:l}=n;const u=(null!==l&&void 0!==l?l:i).Provider;return(0,o.jsx)(r.Provider,{context:s,store:e.getStore(),serverState:t,children:(0,o.jsx)(u,{value:{client:e,useDispatch:(0,r.createDispatchHook)(s),useSelector:(0,r.createSelectorHook)(s),useStore:(0,r.createStoreHook)(s)},children:a})})}}},69617:(e,t,s)=>{s.d(t,{XI:()=>l,Jd:()=>u});var o=s(14041),n=s(84719);const r=e=>()=>{const{useSelector:t}=(0,o.useContext)(e),s=(0,n.n)("auth",e);return"authenticated"===t((0,o.useMemo)((()=>s?s.authSelectors.getAuthStatus:()=>"unknown"),[s]))},i=e=>()=>{const{useSelector:t}=(0,o.useContext)(e),s=(0,n.n)("auth",e);return t((0,o.useMemo)((()=>s?s.authSelectors.getUser:()=>null),[s]))};var a=s(20418);const{useIsAuthenticated:l,useUser:u}=(c=a.Ie,{useIsAuthenticated:r(c),useUser:i(c)});var c},72841:(e,t,s)=>{s.d(t,{zY:()=>m});s(69375);var o=s(57361),n=s(66957),r=s(14041),i=s(69617),a=s(34721),l=s(84719);const u=new n.Logger("useGetIsManagedUser"),c=e=>()=>{const{useSelector:t,useDispatch:s,useStore:n}=(0,r.useContext)(e),c=(0,l.n)("family",e),d=null===c||void 0===c?void 0:c.familySelectors,v=null===c||void 0===c?void 0:c.actions,p=(0,i.Jd)(),g=null===p||void 0===p?void 0:p.xuid,m=(0,r.useCallback)((e=>d?d.getCurrentIsManagedUserStateLCE(e):o.LCE_NOT_REQUESTED),[d]),f=(0,r.useMemo)((()=>{if(!g||!v){const e=[];return g||e.push("xuid is undefined"),v||e.push("family plugin is not loaded"),void u.warn(`Cannot set family state: ${e.join(", ")}`)}return null===v||void 0===v?void 0:v.fetchUserFamily.start(g)}),[v,g]);return(0,a.r)(c,m,f,void 0,{useSelector:t,useDispatch:s,useStore:n})},d=new n.Logger("useFamilyState"),v=e=>()=>{const{useSelector:t,useDispatch:s,useStore:n}=(0,r.useContext)(e),u=(0,l.n)("family",e),c=null===u||void 0===u?void 0:u.familySelectors,v=null===u||void 0===u?void 0:u.actions,p=(0,i.Jd)(),g=null===p||void 0===p?void 0:p.xuid,m=(0,r.useCallback)((e=>c?c.getCurrentXuidFamilyInfoStateLCE(e):o.LCE_NOT_REQUESTED),[c]),f=(0,r.useMemo)((()=>{if(!g||!v){const e=[];return g||e.push("xuid is undefined"),v||e.push("family plugin is not loaded"),void d.warn(`Cannot set family state: ${e.join(", ")}`)}return null===v||void 0===v?void 0:v.fetchUserFamily.start(g)}),[v,g]);return(0,a.r)(u,m,f,void 0,{useSelector:t,useDispatch:s,useStore:n})};var p=s(20418);const{useUserFamilyInfoState:g,useIsManagedUserState:m}=(f=p.Ie,{useUserFamilyInfoState:v(f),useIsManagedUserState:c(f)});var f},34721:(e,t,s)=>{s.d(t,{y:()=>a,r:()=>i});var o=s(57361),n=s(55688),r=s(3093);function i(e,t,s,i,a){const l=function(e){return(0,r.useEventListener)(null===e||void 0===e?void 0:e.signInActionEventListener,n.CommonActionType.UserSignedIn),(0,r.useEventListener)(null===e||void 0===e?void 0:e.signInActionEventListener,n.CommonActionType.UserSignedOut),null===e||void 0===e?void 0:e.hasConsumedSignInAction}(e),u=(0,o.useReduxLce)(t,l?s:void 0,i,a);return(0,o.useLceWithConditions)(u,{fetching:!e})}function a(e,t,s,n,r,i){return(0,o.useMultipleReduxLces)(t,null!==e&&void 0!==e&&e.hasConsumedSignInAction?s:void 0,n,r,i)}},84719:(e,t,s)=>{s.d(t,{n:()=>i});var o=s(14041),n=s(38132),r=s(20418);const i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Ie;const{client:s}=(0,o.useContext)(t),i=s.addOrGetPlugin(e),a=(0,n.I)((0,o.useCallback)((()=>i.promise),[i.promise]),null!=i.plugin);return null!==a&&void 0!==a?a:i.plugin}},91410:(e,t,s)=>{s.d(t,{zn:()=>It,SI:()=>Ut,Kt:()=>Ot,aM:()=>At,Kq:()=>Nt,zE:()=>Mt,fl:()=>jt,Rd:()=>Gt,T6:()=>Ct,gw:()=>mt,R5:()=>gt,X1:()=>vt,b0:()=>wt,$R:()=>st,xR:()=>dt,l_:()=>pt,gL:()=>Lt,yo:()=>$t,FK:()=>Rt,O3:()=>Ht,l:()=>Pt,Vy:()=>Tt,$M:()=>_t,ac:()=>Dt,vd:()=>Bt,mm:()=>yt,qG:()=>Xt,uO:()=>nt,OC:()=>ot,dd:()=>et,rl:()=>Ze,xu:()=>kt,hk:()=>Ft,Ny:()=>xt,MK:()=>ft,Q3:()=>St,HQ:()=>it,qE:()=>Wt,eQ:()=>bt,n2:()=>qt,VR:()=>Qt,Ud:()=>rt,ZE:()=>ht,gg:()=>Jt,z1:()=>ut,vH:()=>at,sj:()=>ct,JP:()=>lt,rv:()=>Et,LV:()=>tt});s(10865),s(47010);var o=s(66957),n=s(14041),r=s(84777),i=s(19183),a=s(69617),l=s(72841),u=s(84719);const c=new o.Logger("useAcceptFriendRequest"),d=e=>(t,s,o,d)=>{const{useDispatch:v}=(0,n.useContext)(e),p=v(),g=(0,u.n)("people",e),m=(0,u.n)("trust",e),f=(0,a.Jd)(),S=null===f||void 0===f?void 0:f.xuid,[h]=(0,l.zY)(),C=(0,n.useCallback)((async e=>{if(g&&t&&S)try{c.info(`ramah - accepting friend request from xuid ${t}`),await g.socialService.acceptFriendRequest(S,t,e),p(g.actions.acceptFriendRequestSucceeded(t,s)),p(g.actions.getPerson.start(S,!0)),null===o||void 0===o||o()}catch(n){const e=g.customPeopleActions.acceptFriendRequestFailed();if(n instanceof g.socialServiceError)if(m&&n.code===g.socialServiceErrorCode.ParentalControlCheckFailed&&h)try{p(m.actions.displayAddFriendModal(S,t,r.p.Accept))}catch(i){p(e)}else n.code===g.socialServiceErrorCode.PeopleListFull||n.code===g.socialServiceErrorCode.FriendsModifyErrorListFull||n.code===g.socialServiceErrorCode.FriendsModifyErrorOtherListFull?p(g.customPeopleActions.maxFriendCountReached()):p(e);else p(e);null===d||void 0===d||d()}}),[g,t,S,p,s,o,d,m,h]);return(0,i.I)(C,!!g&&!!t&&!!S)};var v=s(57361),p=s(67814);const g=new o.Logger("useActiveLinkTokens"),m=e=>()=>{const t=(0,u.n)("people",e),[s,o]=(0,n.useState)(v.LCE_NOT_REQUESTED),r=(0,n.useCallback)((()=>{t&&(o((0,v.lceFetching)()),t.fetchActiveOpenEndedInviteLinks().then((e=>{o((0,v.lceContent)(e))})).catch((e=>{const t=(0,p.g)(e);g.error("An unexpected error occurred when trying fetch existing link tokens",t),o((0,v.lceError)(t))})))}),[t]),i=(0,n.useCallback)((()=>{o(v.LCE_NOT_REQUESTED)}),[]),a=(0,v.useLce)(s);return(0,n.useMemo)((()=>[...a,{getActiveLinkTokens:r,clearActiveLinkTokens:i}]),[a,r,i])},f=new o.Logger("useBatchAcceptFriendRequests"),S=e=>(t,s)=>{const{useDispatch:o}=(0,n.useContext)(e),r=o(),a=(0,u.n)("people",e),l=(0,n.useCallback)((async()=>{if(a)try{f.info(`ramah - accept all friend requests from xuids ${t}`);const e=await a.socialService.batchAcceptFriendRequests(t);e.updatedXuids&&e.updatedXuids.length>0&&(r(a.actions.acceptFriendRequestsSucceeded(e.updatedXuids,!1)),null===s||void 0===s||s(e.updatedXuids)),e.failedToUpdateXuids&&e.failedToUpdateXuids.length>0&&r(a.customPeopleActions.batchAcceptFriendRequestsFailed())}catch(e){r(a.customPeopleActions.batchAcceptFriendRequestsFailed())}}),[r,s,a,t]);return(0,i.I)(l,!!a)},h=new o.Logger("useBatchCancelFriendRequests"),C=e=>(t,s)=>{const{useDispatch:o}=(0,n.useContext)(e),r=o(),a=(0,u.n)("people",e),l=(0,n.useCallback)((async()=>{if(a)try{h.info(`ramah - cancel all friend requests from xuids ${t}`);const e=await a.socialService.batchCancelFriendRequests(t);e.updatedXuids&&e.updatedXuids.length>0&&(r(a.actions.cancelFriendRequestsSucceeded(e.updatedXuids,!1)),null===s||void 0===s||s(e.updatedXuids)),e.failedToUpdateXuids&&e.failedToUpdateXuids.length>0&&r(a.customPeopleActions.batchCancelFriendRequestsFailed())}catch(e){r(a.customPeopleActions.batchCancelFriendRequestsFailed())}}),[r,s,a,t]);return(0,i.I)(l,!!a)},F=new o.Logger("useBatchDeclineFriendRequests"),E=e=>(t,s)=>{const{useDispatch:o}=(0,n.useContext)(e),r=o(),a=(0,u.n)("people",e),l=(0,n.useCallback)((async()=>{if(a)try{F.info(`ramah - decline all friend requests from xuids ${t}`);const e=await a.socialService.batchDeclineFriendRequests(t);e.updatedXuids&&e.updatedXuids.length>0&&(r(a.actions.declineFriendRequestsSucceeded(e.updatedXuids,!1)),null===s||void 0===s||s(e.updatedXuids)),e.failedToUpdateXuids&&e.failedToUpdateXuids.length>0&&r(a.customPeopleActions.batchDeclineFriendRequestsFailed())}catch(e){r(a.customPeopleActions.batchDeclineFriendRequestsFailed())}}),[r,s,a,t]);return(0,i.I)(l,!!a)},k=new o.Logger("useCancelFriendRequest"),y=e=>(t,s,o,r)=>{const{useDispatch:l}=(0,n.useContext)(e),c=l(),d=(0,u.n)("people",e),v=(0,a.Jd)(),p=null===v||void 0===v?void 0:v.xuid,g=(0,n.useCallback)((async()=>{if(d&&t&&p)try{k.info(`ramah - canceling friend request to xuid ${t}`),await d.socialService.cancelFriendRequest(p,t),c(d.actions.cancelFriendRequestSucceeded(t,s)),null===r||void 0===r||r()}catch(e){c(d.customPeopleActions.cancelFriendRequestFailed())}finally{null===o||void 0===o||o()}}),[d,t,p,c,s,r,o]);return(0,i.I)(g,!!d&&!!t&&!!p)},R=e=>(t,s,r,i)=>{const a=(0,u.n)("people",e),l=(0,o.useLogger)("useCommitNewGamertag"),[c,d]=(0,n.useState)(v.LCE_NOT_REQUESTED);return(0,n.useEffect)((()=>{a&&(d((0,v.lceFetching)()),null===a||void 0===a||a.gamertagService.commitGamertagChange(t,s,r,i).then((()=>{d((0,v.lceContent)(!0))})).catch((e=>{const t=(0,p.g)(e);d((0,v.lceError)(t)),l.error(`Failed to commit and change the new gamertag(s):  ${t}`)})))}),[a,r,i,l,t,s]),(0,v.useLce)(c)},L=new o.Logger("useDeclineFriendRequest"),U=e=>(t,s,o,r)=>{const{useDispatch:l}=(0,n.useContext)(e),c=l(),d=(0,u.n)("people",e),v=(0,a.Jd)(),p=null===v||void 0===v?void 0:v.xuid,g=(0,n.useCallback)((async()=>{if(d&&t&&p)try{L.info(`ramah - declining request from xuid ${t}`),await d.socialService.declineFriendRequest(p,t),c(d.actions.declineFriendRequestSucceeded(t,s)),null===o||void 0===o||o()}catch(e){c(d.customPeopleActions.declineFriendRequestFailed()),null===r||void 0===r||r()}}),[d,t,p,c,s,o,r]);return(0,i.I)(g,!!d&&!!t&&!!p)};s(81045),s(45950);var b=s(12885);const x=new o.Logger("useFindJoinableSessionFromXuid"),w=e=>(t,s)=>{const o=(0,u.n)("people",e),[r,i]=(0,n.useState)(v.LCE_NOT_REQUESTED);return(0,n.useEffect)((()=>{o&&t&&s&&(i((0,v.lceFetching)()),o.multiplayerService.getActivitiesForXuidsAsync([t]).then((e=>{const o=e[t].find((e=>e.titleId===s));i((0,v.lceContent)(o||null))})).catch((e=>{const t=(0,b.toError)(e);x.error("Failed to fetch joinable session",t),i((0,v.lceError)(t))})))}),[o,s,t]),(0,v.useLce)(r)};var T=s(34721);s(33975);const _=(e,t)=>e.sort(((e,s)=>{if(e.xuid===t)return-1;if(s.xuid===t)return 1;if(e.isFriend&&s.isFriend){if(e.isFavorite&&!s.isFavorite)return-1;if(!e.isFavorite&&s.isFavorite)return 1}return e.isFriend&&!s.isFriend?-1:!e.isFriend&&s.isFriend?1:e.gamertag.uniqueGamertag.localeCompare(s.gamertag.uniqueGamertag)})),P=e=>()=>{const{useSelector:t,useDispatch:s,useStore:o}=(0,n.useContext)(e),r=(0,u.n)("people",e),i=null===r||void 0===r?void 0:r.peopleSelectors,a=null===r||void 0===r?void 0:r.actions,l=(0,n.useCallback)((e=>i?i.getFollowersLCE(e,r.decoration.Presence):v.LCE_NOT_REQUESTED),[r,i]),c=(0,n.useMemo)((()=>null===a||void 0===a?void 0:a.getFollowers.start(["presenceDetail"])),[a]),d=s(),p=(0,n.useCallback)((()=>{c&&d(c)}),[d,c]),[,g]=(0,T.r)(r,l,c,void 0,{useSelector:t,useDispatch:s,useStore:o}),m=(0,n.useMemo)((()=>(0,v.lceTransform)(g,(e=>_(e)))),[g]);return(0,v.useLce)(m,p)},D=(0,v.lceFetching)(),I=e=>(t,s)=>{const{useSelector:o,useDispatch:r,useStore:i}=(0,n.useContext)(e),l=(0,a.XI)(),c=(0,u.n)("people",e),d=(0,n.useMemo)((()=>{const e=["Presence","Detail","MultiplayerSummary"],t=s?[...e,...s]:e;let o=0;if(c)for(const s of t)switch(s){case"Presence":o|=c.decoration.Presence;break;case"PreferredColors":o|=c.decoration.PreferredColors;break;case"Detail":o|=null===c||void 0===c?void 0:c.decoration.Detail;break;case"Recommendation":o|=c.decoration.Recommendation;break;case"MultiplayerSummary":o|=c.decoration.MultiplayerSummary;break;case"RecentPlayer":o|=c.decoration.RecentPlayer}return o}),[s,c]),p=null===c||void 0===c?void 0:c.peopleSelectors,{getProfiles:g}=(0,n.useMemo)((()=>t?p?p.makeGroupSelectors(t):{getProfiles:()=>Array(t.length).fill(D)}:{getProfiles:()=>[v.LCE_NOT_REQUESTED]}),[t,p]),m=(0,n.useMemo)((()=>t&&c&&l?c.actions.getPeople.start(t):void 0),[t,c,l]);return(0,T.y)(c,(e=>g(e,d)),m,{skipErrors:!0},void 0,{useSelector:o,useDispatch:r,useStore:i})},G=e=>{const t=I(e);return s=>{const{useSelector:o,useDispatch:r,useStore:i}=(0,n.useContext)(e),l=(0,u.n)("people",e),c=null===l||void 0===l?void 0:l.peopleSelectors,d=null===l||void 0===l?void 0:l.actions,p=(0,a.Jd)(),g=null===p||void 0===p?void 0:p.xuid,m=(0,n.useCallback)((e=>c&&s?c.getFollowedByUserXuidsLCE(e,s):v.LCE_NOT_REQUESTED),[c,s]),f=(0,n.useMemo)((()=>s?null===d||void 0===d?void 0:d.getFollowedByUser.start(s):void 0),[d,s]),S=r(),h=(0,n.useCallback)((()=>{f&&S(f)}),[S,f]),[C,F]=(0,T.r)(l,m,f,void 0,{useSelector:o,useDispatch:r,useStore:i}),[,E]=t(C),k=(0,n.useMemo)((()=>(0,v.lceTransform)((0,v.lceMerge)(F,E,{onlyRequireOneNotRequested:!0}),(e=>{let[t,s]=e;return t&&s?_(s,g):[]}))),[g,F,E]);return(0,v.useLce)(k,h)}},M=e=>function(t){const{useDispatch:s}=(0,n.useContext)(e),o=(0,u.n)("people",e),r=(0,u.n)("trust",e),c=s(),d=(0,a.Jd)(),v=null===d||void 0===d?void 0:d.xuid,[p]=(0,l.zY)(),[g]=Ze(t),m=(0,n.useCallback)((async()=>{if(o&&v)if(g&&g.detail&&!g.detail.canBeFollowed)c(o.customPeopleActions.allowFollowersBlocked());else try{await o.socialService.followUser(v,t),c(o.actions.followUserSucceeded(t)),c(o.actions.getPerson.start(v,!0))}catch(e){const n=o.customPeopleActions.followUserFailed(v,t);if(e instanceof o.socialServiceError)if(r&&e.code===o.socialServiceErrorCode.ParentalControlCheckFailed&&p)try{c(r.actions.displayFollowUserModal(v,t))}catch(s){c(n)}else e.code===o.socialServiceErrorCode.FriendRequestPrivacyFail?c(o.customPeopleActions.allowFollowersBlocked()):e.code!==o.socialServiceErrorCode.PeopleListFull&&e.code!==o.socialServiceErrorCode.FriendsModifyErrorListFull&&e.code!==o.socialServiceErrorCode.FriendsModifyErrorOtherListFull||c(o.customPeopleActions.maxFollowingCountReached());else c(n)}}),[o,v,g,c,t,r,p]);return(0,i.I)(m,!!o&&!!v)};s(97107);const q=e=>t=>{const s=(0,u.n)("people",e),[o,r]=(0,n.useState)((0,v.lceFetching)());return(0,n.useEffect)((()=>{s&&t&&s.socialService.getFriendLinkPreview(t).then((e=>{r(e?(0,v.lceContent)(e):(0,v.lceError)(new Error("getFriendLinkPreview request was successful but a friend link wasn't returned")))})).catch((e=>{const t=(0,p.g)(e);r((0,v.lceError)(t))}))}),[t,s]),(0,v.useLce)(o)},O=(e,t)=>{var s,o;const n=null!==(s=e.gamertag.uniqueGamertag)&&void 0!==s?s:e.gamertag.legacyGamertag,r=null!==(o=t.gamertag.uniqueGamertag)&&void 0!==o?o:t.gamertag.legacyGamertag;return n.localeCompare(r,void 0,{sensitivity:"accent"})},A=(e,t)=>{var s,o,n,r;return(null===(s=e.presence)||void 0===s?void 0:s.presenceState)===(null===(o=t.presence)||void 0===o?void 0:o.presenceState)?0:"online"===(null===(n=e.presence)||void 0===n?void 0:n.presenceState)?-1:"online"===(null===(r=t.presence)||void 0===r?void 0:r.presenceState)?1:0},N=(e,t)=>{var s,o,n;return(null===(s=e.presence)||void 0===s?void 0:s.presenceIsGame)===(null===(o=t.presence)||void 0===o?void 0:o.presenceIsGame)?0:null!==(n=e.presence)&&void 0!==n&&n.presenceIsGame?-1:1},X=(e,t)=>e.isFavorite===t.isFavorite?0:e.isFavorite?-1:1,B=(e,t)=>((e,t,s)=>{for(const o of s){const s=o(e,t);if(0!==s)return s}return 0})(e,t,[A,X,N,O]),Q=e=>()=>{const{useSelector:t,useDispatch:s,useStore:o}=(0,n.useContext)(e),r=(0,u.n)("people",e),i=null===r||void 0===r?void 0:r.peopleSelectors,a=null===r||void 0===r?void 0:r.actions,l=(0,n.useCallback)((e=>i?i.getFriendsLCE(e):v.LCE_NOT_REQUESTED),[i]),c=null===a||void 0===a?void 0:a.getFriends.start(),[,d]=(0,T.r)(r,l,c,void 0,{useSelector:t,useDispatch:s,useStore:o}),p=(0,n.useMemo)((()=>(0,v.lceTransform)(d,(e=>e.sort(B)))),[d]);return(0,v.useLce)(p)};s(30163);const J=e=>{const t=I(e);return s=>{const{useSelector:o,useDispatch:r,useStore:i}=(0,n.useContext)(e),l=(0,u.n)("people",e),c=null===l||void 0===l?void 0:l.peopleSelectors,d=null===l||void 0===l?void 0:l.actions,p=(0,a.Jd)(),g=null===p||void 0===p?void 0:p.xuid,m=(0,n.useCallback)((e=>c&&s?c.getFriendsOfUserXuidsLCE(e,s):v.LCE_NOT_REQUESTED),[c,s]),f=(0,n.useMemo)((()=>s?null===d||void 0===d?void 0:d.getFriendsOfUser.start(s):void 0),[d,s]),S=r(),h=(0,n.useCallback)((()=>{f&&S(f)}),[S,f]),[C,F]=(0,T.r)(l,m,f,void 0,{useSelector:o,useDispatch:r,useStore:i}),[,E]=t(C),k=(0,n.useMemo)((()=>(0,v.lceTransform)((0,v.lceMerge)(F,E,{onlyRequireOneNotRequested:!0}),(e=>{let[t,o]=e;if(!t||!o)return[];const n=s===g?o.filter((e=>e.isFriend)):o;return _(n,g)}))),[g,F,E,s]);return(0,v.useLce)(k,h)}},$=e=>t=>{const{useSelector:s,useDispatch:o,useStore:r}=(0,n.useContext)(e),i=(0,u.n)("people",e),a=null===i||void 0===i?void 0:i.peopleSelectors,l=(0,n.useCallback)((e=>t&&a?a.getFriendsWhoPlayLCE(e,t):v.LCE_NOT_REQUESTED),[a,t]),c=(0,n.useMemo)((()=>{if(i&&t)return i.actions.getFriendsWhoPlay.start(t)}),[i,t]);return(0,T.r)(i,l,c,void 0,{useSelector:s,useDispatch:o,useStore:r})};var W=s(41506),j=s.n(W);s(64727);const H=new o.Logger("useGameInviteFromLinkToken"),z=e=>()=>{const t=(0,u.n)("people",e);return(0,n.useCallback)((async e=>{if(t)try{const s=await t.fetchActivityFromLinkToken(e);return s.activityType===t.activityType.None?void H.error(`Link token no longer active: ${e}`):{rawNotification:JSON.stringify(j()(j()({},s),{},{notificationData:s.activityType===t.activityType.Mpa?j()(j()({},s.connectionData),{},{titleName:""}):{sender:s.gamertag,connectionString:"",activationInfo:s.inviteHandle.gameTypes,invitedUser:s.inviteHandle.senderXuid,titleName:s.inviteHandle.activityInfo.titleName}})),titleId:s.titleId,actor:{xuid:s.gamertag.xuid,gamertag:{legacyGamertag:s.gamertag.gamertag,base:s.gamertag.modernGamertag,suffix:s.gamertag.modernGamertagSuffix,uniqueGamertag:s.gamertag.uniqueModernGamertag}}}}catch(s){const t=(0,p.g)(s);return void H.error(`An unexpected error occurred when trying to redeem the link token ${e} for game invite`,t)}}),[t])},K=e=>t=>{const s=(0,u.n)("people",e),r=(0,o.useLogger)("useGenerateGamertags"),[i,a]=(0,n.useState)(v.LCE_NOT_REQUESTED);(0,n.useEffect)((()=>{a(v.LCE_NOT_REQUESTED)}),[t,a]);const l=(0,n.useCallback)((async()=>{s&&(a((0,v.lceFetching)()),s.gamertagService.generateGamertags(t).then((e=>{a((0,v.lceContent)(e))})).catch((e=>{const t=(0,p.g)(e);a((0,v.lceError)(t)),r.error("Failed to get generated gamertags: ",t)})))}),[s,r,t,a]),c=(0,n.useCallback)((()=>a(v.LCE_NOT_REQUESTED)),[a]),d=(0,v.useLce)(i);return(0,n.useMemo)((()=>[...d,{generateGamertag:l,clearGeneratedGamertags:c}]),[d,l,c])},V=new o.Logger("useGenerateOpenEndedInviteLinkToken"),Y=e=>t=>{const s=(0,u.n)("people",e),[o,r]=(0,n.useState)(v.LCE_NOT_REQUESTED);(0,n.useEffect)((()=>r(v.LCE_NOT_REQUESTED)),[t]);const i=(0,n.useCallback)((()=>{s&&t&&(r((0,v.lceFetching)()),s.fetchOpenEndedLinkTokenFromTitleId(t).then((e=>{r((0,v.lceContent)(e.linkToken))})).catch((e=>{const s=(0,p.g)(e);V.error(`An unexpected error occurred when trying to create a link token for titleId ${t}`,s),r((0,v.lceError)(s))})))}),[s,t]),a=(0,n.useCallback)((()=>r(v.LCE_NOT_REQUESTED)),[]),l=(0,v.useLce)(o);return(0,n.useMemo)((()=>[...l,{generateLinkToken:i,clearLinkToken:a}]),[l,i,a])};s(93510);const Z=e=>({code:Number(e.code),description:e.description}),ee=e=>()=>{const t=(0,u.n)("people",e),s=(0,o.useLogger)("useGetCanUserChangeGamertagForFree"),[r,i]=(0,n.useState)(v.LCE_NOT_REQUESTED);return(0,n.useEffect)((()=>{(async()=>{!t||(0,v.isFetching)(r)||(0,v.isContent)(r)||(i((0,v.lceFetching)()),t.gamertagService.getCanUserChangeGamertagForFree("","","").then((e=>{i((0,v.lceContent)({hasFree:e.hasFree,hasModernGamertag:e.hasModernGamertag,hasEntitlement:!0}))})).catch((async e=>{const t=await e.response.json(),{code:o,description:n}=Z(t);if(5025===o)i((0,v.lceContent)({hasFree:!1,hasModernGamertag:!0,hasEntitlement:!1}));else{const t=(0,p.g)(e);i((0,v.lceError)(t)),s.error("Failed to get the current gamertag status and entitlement: ",n||t)}})))})()}),[t,r,s]),(0,v.useLce)(r)},te=e=>()=>{const{useSelector:t}=(0,n.useContext)(e),s=(0,u.n)("people",e),o=null===s||void 0===s?void 0:s.peopleSelectors,r=(0,n.useCallback)((e=>o?o.getFriendRequestSummaryLCE(e):v.LCE_NOT_REQUESTED),[o]);return(0,v.useLce)(t(r))},se=e=>()=>{const{useDispatch:t}=(0,n.useContext)(e),s=(0,u.n)("people",e),o=(0,a.XI)(),r=t(),l=(0,n.useCallback)(((e,t)=>{s&&o&&r(s.actions.getPerson.start(e,t,["detail","multiplayerSummary","presenceDetail","preferredColor"]))}),[r,s,o]);return(0,i.I)(l,!!s)},oe=e=>()=>{const{useSelector:t,useDispatch:s,useStore:o}=(0,n.useContext)(e),r=(0,u.n)("people",e),i=null===r||void 0===r?void 0:r.peopleSelectors,a=null===r||void 0===r?void 0:r.actions,l=(0,n.useCallback)((e=>i?i.getReceivedFriendRequestsLCE(e,r.decoration.Detail):v.LCE_NOT_REQUESTED),[null===r||void 0===r?void 0:r.decoration,i]),c=(0,n.useMemo)((()=>null===a||void 0===a?void 0:a.getReceivedFriendRequests.start()),[a]);return(0,T.r)(r,l,c,void 0,{useSelector:t,useDispatch:s,useStore:o})},ne=e=>()=>{const{useSelector:t,useDispatch:s,useStore:o}=(0,n.useContext)(e),r=(0,u.n)("people",e),i=null===r||void 0===r?void 0:r.peopleSelectors,a=null===r||void 0===r?void 0:r.actions,l=(0,n.useCallback)((e=>i?i.getSentFriendRequestsLCE(e):v.LCE_NOT_REQUESTED),[i]),c=(0,n.useMemo)((()=>null===a||void 0===a?void 0:a.getSentFriendRequests.start()),[a]);return(0,T.r)(r,l,c,void 0,{useSelector:t,useDispatch:s,useStore:o})};s(69375),s(75604),s(41532),s(32950),s(73599),s(64770),s(62080),s(97012),s(31274),s(29548),s(47342),s(14825),s(92467),s(67497),s(88236);var re=s(47283),ie=s(79824),ae=s(87309),le=s(49578),ue=s(15387),ce=s(50906);const de=e=>()=>{const t=(0,u.n)("people",e),s=(0,ue.G_)(ae.H.EnableParties),o=(0,ie.useSelector)(re.Kj),[,r]=Ze(o),[,i]=(0,le.J)(),a=(0,n.useMemo)((()=>(0,v.lceTransform)((0,v.lceMerge)(r,i,{onlyRequireOneNotRequested:!0}),(e=>{let[o,n]=e;if(!n)return null;const{friendsInJoinableSessions:r,activeFriends:i}=n,a=new Map;if(!s)return{friendsInJoinableSessions:r,joinableParties:a,activeFriends:i};const l=(0,ce.x)(o);for(const s of r){var u;const e=(0,ce.x)(s),o=null===t||void 0===t?void 0:t.isUserInJoinableParty(null===(u=s.multiplayerSummary)||void 0===u?void 0:u.party,s.isFriend);e&&e!==l&&o&&(a.has(e)?a.get(e).push(s):a.set(e,[s]))}for(const s of i){var c;const e=(0,ce.x)(s),o=null===t||void 0===t?void 0:t.isUserInJoinableParty(null===(c=s.multiplayerSummary)||void 0===c?void 0:c.party,s.isFriend);e&&e!==l&&o&&(a.has(e)?a.get(e).push(s):a.set(e,[s]))}return{friendsInJoinableSessions:r,joinableParties:a,activeFriends:i}}))),[r,s,i,t]);return(0,v.useLce)(a)};var ve=s(94787),pe=s(78672);const ge=new o.Logger("useInviteUsersToGame"),me=e=>function(){const t=(0,u.n)("people",e),{trackUserAction:s}=(0,ve.o3)();return(0,n.useCallback)((async(e,o)=>{if(t)try{s(pe.a.SendGameInvite,void 0,{xuids:e,titleId:o}),await t.inviteUsersToGame(e,o)}catch(n){const t=(0,b.toError)(n);ge.error(`An unexpected error occurred when trying to invite users to the game (${o}): ${e}:${t}`)}else ge.info("people plugin is not loaded")}),[t,s])},fe=e=>(t,s)=>{const{useSelector:o,useDispatch:r,useStore:i}=(0,n.useContext)(e),l=(0,a.XI)(),c=(0,u.n)("people",e),d=(0,n.useMemo)((()=>{const e=["Presence","Detail","MultiplayerSummary"],t=s?[...e,...s]:e;let o=0;if(c)for(const s of t)switch(s){case"Presence":o|=c.decoration.Presence;break;case"PreferredColors":o|=c.decoration.PreferredColors;break;case"Detail":o|=null===c||void 0===c?void 0:c.decoration.Detail;break;case"Recommendation":o|=c.decoration.Recommendation;break;case"MultiplayerSummary":o|=c.decoration.MultiplayerSummary;break;case"RecentPlayer":o|=c.decoration.RecentPlayer}return o}),[s,c]),p=null===c||void 0===c?void 0:c.peopleSelectors,{getProfileLCE:g}=(0,n.useMemo)((()=>t&&p?p.makePersonSelectors(t):{getProfileLCE:()=>v.LCE_NOT_REQUESTED}),[t,p]),m=(0,n.useMemo)((()=>t&&c&&l?c.actions.getPerson.start(t):void 0),[t,c,l]);return(0,v.useLceWithConditions)((0,T.r)(c,(e=>g(e,d)),m,void 0,{useSelector:o,useDispatch:r,useStore:i}),{notRequested:!t})},Se=e=>t=>{var s;const o=(0,u.n)("people",e),n=fe(e),[r]=n(t);return!!r&&(null===o||void 0===o?void 0:o.isUserInJoinableParty(null===(s=r.multiplayerSummary)||void 0===s?void 0:s.party,r.isFriend))},he=e=>{const t=Q(e);return()=>{const s=(0,u.n)("people",e),[,o]=t(),r=(0,n.useMemo)((()=>(0,v.lceTransform)(o,(e=>s?e.filter((e=>{var t;return(null===(t=e.presence)||void 0===t?void 0:t.presenceState)!==s.presenceState.Online})):[]))),[o,s]);return(0,v.useLce)(r)}},Ce=e=>{const t=Q(e);return()=>{const s=(0,u.n)("people",e),[,o]=t(),r=(0,n.useMemo)((()=>(0,v.lceTransform)(o,(e=>s?e.filter((e=>{var t;return(null===(t=e.presence)||void 0===t?void 0:t.presenceState)===s.presenceState.Online})):[]))),[o,s]);return(0,v.useLce)(r)}},Fe=e=>{const t=fe(e);return e=>{const[,s]=t(e,["Detail"]),o=(0,n.useMemo)((()=>(0,v.lceTransform)(s,(e=>{var t,s;const o=null!==(t=null===(s=e.detail)||void 0===s?void 0:s.watermarks)&&void 0!==t?t:[],n=[];for(const r of o)n.push({imageUrl:Ee(r),id:r});return n}))),[s]);return(0,v.useLce)(o)}};function Ee(e){return`https://dlassets-ssl.xboxlive.com/public/content/ppl/watermarks/${arguments.length>1&&void 0!==arguments[1]?arguments[1]:"launch"}/${e.toLowerCase()}.png`}const ke=e=>()=>{const{useSelector:t,useDispatch:s,useStore:o}=(0,n.useContext)(e),r=(0,u.n)("people",e),i=null===r||void 0===r?void 0:r.peopleSelectors,a=(0,n.useCallback)((e=>i?i.getRecentPlayersLCE(e):v.LCE_NOT_REQUESTED),[i]);return(0,T.r)(r,a,null===r||void 0===r?void 0:r.actions.getRecentPlayers.start(),void 0,{useSelector:t,useDispatch:s,useStore:o})},ye=new o.Logger("useRedeemFriendInviteLink"),Re=e=>()=>{const{useDispatch:t}=(0,n.useContext)(e),s=t(),o=(0,u.n)("people",e),r=(0,a.XI)(),l=(0,a.Jd)(),c=null===l||void 0===l?void 0:l.xuid,d=(0,n.useCallback)((async(e,t,n)=>{if(o&&r&&c)try{await o.socialService.redeemFriendLink(e,t),s(o.actions.getPerson.start(e,!0)),null===n||void 0===n||n(!0)}catch(i){const e=(0,p.g)(i);ye.error("Failed to redeem friend invite link",e),null===n||void 0===n||n(!1)}}),[c,s,r,o]);return(0,i.I)(d,!!o&&r)},Le=new o.Logger("useRemoveFollower"),Ue=e=>function(t){const{useDispatch:s}=(0,n.useContext)(e),o=(0,u.n)("people",e),r=s(),l=(0,a.Jd)(),c=null===l||void 0===l?void 0:l.xuid,d=(0,n.useCallback)((async()=>{if(o&&c)try{await o.socialService.removeFollower(t),r(o.actions.removeFollowerSucceeded(c,t)),r(o.actions.getPerson.start(c,!0))}catch(e){const t=(0,p.g)(e);Le.error(t.message)}}),[c,r,o,t]);return(0,i.I)(d,!!o&&!!c&&!!t)},be=new o.Logger("useRemoveFriend"),xe=e=>function(t){const{useDispatch:s}=(0,n.useContext)(e),o=(0,u.n)("people",e),r=s(),l=(0,a.Jd)(),c=null===l||void 0===l?void 0:l.xuid,d=(0,n.useCallback)((async()=>{if(o&&c)try{await o.socialService.removeFriend(t),r(o.actions.removeFriendSucceeded(c,t)),r(o.actions.getPerson.start(c,!0))}catch(e){const t=(0,p.g)(e);be.error(t.message)}}),[c,r,o,t]);return(0,i.I)(d,!!o&&!!c&&!!t)},we=e=>t=>{const s=(0,u.n)("people",e),{useDispatch:o}=(0,n.useContext)(e),r=o(),a=(0,n.useCallback)((()=>{s&&r(s.actions.removeRecommendation.start(t))}),[t,s,r]);return(0,i.I)(a,!!s)};var Te=s(37509),_e=s(93441);const Pe=e=>(t,s,r)=>{const i=(0,u.n)("people",e),a=(0,o.useLogger)("useReserveGamertag"),[l]=Ze(t),c=l?l.gamertag.base:void 0,d=null===l||void 0===l?void 0:l.gamertag.legacyGamertag,[g,m,f,S,h,C,F,E,k]=(0,_e.cG)("ChangeGamertag_Error_Classic_Gamertag_Conflict","ChangeGamertag_Error_Classic_Gamertag_Contains_Invalid_text","ChangeGamertag_Error_Starts_With_Invalid_Text","ChangeGamertag_Error_Not_Allowed_Text","ChangeGamertag_Error_Whitespaces_Text","ChangeGamertag_Error_Conflict_Text","ChangeGamertag_Error_Generic_Reserve_Text","ChangeGamertag_Error_Contains_Invalid_text","ChangeGamertag_Error_Already_Owned_Text"),[y,R]=(0,n.useState)(v.LCE_NOT_REQUESTED);(0,n.useEffect)((()=>{R(v.LCE_NOT_REQUESTED)}),[t,s,r]);const L=(0,n.useCallback)((async()=>{i&&t&&(r||s)&&((null===r||void 0===r?void 0:r.toLowerCase().trim())!==(null===c||void 0===c?void 0:c.toLowerCase().trim())&&(null===s||void 0===s?void 0:s.toLowerCase().trim())!==(null===d||void 0===d?void 0:d.toLowerCase().trim())?(R((0,v.lceFetching)()),i.gamertagService.reserveGamertag(t,{modernGamertag:r,classicGamertag:s}).then((e=>{const t={gamertag:e.gamertag,modernGamertag:e.modernGamertag,modernGamertagSuffix:e.modernGamertagSuffix,uniqueModernGamertag:e.uniqueModernGamertag,classicTranslationLevel:e.classicTranslationLevel,promptForClassicGamertag:e.promptForClassicGamertag};R((0,v.lceContent)(t))})).catch((async e=>{let s="";if(e.response){const t=await e.response.json(),{code:o}=Z(t);switch(o){case 1001:s=g;break;case 1002:s=m;break;case 1007:{const e=t.invalidCharacters.join(", ");s=(0,Te.GPZ)(E,e);break}case 1009:s=f;break;case 1012:s=S;break;case 1019:s=h;break;case 1037:s=C;break;default:s=F}R((0,v.lceError)(new Error(s)))}else{const s=(0,p.g)(e);a.error(`Failed to reserve gamertag for XUID: ${t}`,s),R((0,v.lceError)(s))}}))):R((0,v.lceError)(new Error(k))))}),[i,t,r,s,c,d,k,g,m,f,S,h,C,F,E,a]),U=(0,v.useLce)(y);return(0,n.useMemo)((()=>[...U,{reserveGamertag:L}]),[U,L])},De=new o.Logger("useRevokeLinkToken"),Ie=e=>function(){const t=(0,u.n)("people",e);return(0,n.useCallback)((async e=>{if(!t)return De.info("people plugin is not loaded"),!1;if(!e)return De.info("no link token to revoke"),!1;try{return await t.revokeOpenEndedLink(e),!0}catch(s){const t=(0,p.g)(s);return De.error(`An unexpected error occurred when trying to revoke the link token ${e}`,t),!1}}),[t])},Ge=new o.Logger("useSendRequest"),Me=e=>(t,s,o)=>{const{useDispatch:c}=(0,n.useContext)(e),d=c(),v=(0,u.n)("people",e),p=(0,u.n)("trust",e),g=(0,a.Jd)(),m=null===g||void 0===g?void 0:g.xuid,[f]=(0,l.zY)(),[S]=Ze(t),h=(0,n.useCallback)((async e=>{if(v&&m)if(S&&S.detail&&!S.detail.canBeFriended)d(v.customPeopleActions.allowFriendInvitesBlocked());else try{Ge.info(`ramah - sending friend request to ${t}`),await v.socialService.sendFriendRequest(m,t,e),d(v.actions.sendFriendRequestSucceeded(t)),null===s||void 0===s||s()}catch(n){const e=v.customPeopleActions.genericPeopleError();if(n instanceof v.socialServiceError)if(p&&n.code===v.socialServiceErrorCode.ParentalControlCheckFailed&&f)try{d(p.actions.displayAddFriendModal(m,t,r.p.Send))}catch(i){d(e)}else n.code===v.socialServiceErrorCode.FriendRequestPrivacyFail?d(v.customPeopleActions.allowFriendInvitesBlocked()):n.code===v.socialServiceErrorCode.PeopleListFull||n.code===v.socialServiceErrorCode.FriendsModifyErrorListFull||n.code===v.socialServiceErrorCode.FriendsModifyErrorOtherListFull?d(v.customPeopleActions.requestInboxFull()):d(e);else d(e);null===o||void 0===o||o()}}),[m,d,f,o,s,v,S,t,p]);return(0,i.I)(h,!!v&&!!m)},qe=e=>function(t){const{useDispatch:s}=(0,n.useContext)(e),o=(0,u.n)("people",e),r=s(),l=(0,a.Jd)(),c=null===l||void 0===l?void 0:l.xuid,d=(0,n.useCallback)((async()=>{if(o&&c)try{await o.socialService.shareRealNameWithUser(c,t),r(o.actions.shareRealNameWithUser.success(t))}catch(e){const s=(0,p.g)(e);r(o.actions.shareRealNameWithUser.error(o.actions.shareRealNameWithUser.start(c,t),s))}}),[c,r,o,t]);return(0,i.I)(d,!!o&&!!c)},Oe=e=>()=>{const{useSelector:t,useDispatch:s,useStore:o}=(0,n.useContext)(e),r=(0,u.n)("people",e),i=null===r||void 0===r?void 0:r.peopleSelectors,a=null===r||void 0===r?void 0:r.decoration,l=(0,n.useCallback)((e=>i&&a?i.getSuggestedFriendsLCE(e,a.Detail):v.LCE_NOT_REQUESTED),[i,a]);return(0,T.r)(r,l,null===r||void 0===r?void 0:r.actions.getRecommendations.start(["detail"]),void 0,{useSelector:t,useDispatch:s,useStore:o})},Ae=e=>function(t){const{useDispatch:s}=(0,n.useContext)(e),o=(0,u.n)("people",e),r=s(),l=(0,a.Jd)(),c=null===l||void 0===l?void 0:l.xuid,d=(0,n.useCallback)((async()=>{if(o&&c)try{await o.socialService.unfollowUser(c,t),r(o.actions.unfollowUserSucceeded(t)),r(o.actions.getPerson.start(c,!0))}catch(e){const s=o.customPeopleActions.unfollowUserFailed(c,t);r(s)}}),[c,r,o,t]);return(0,i.I)(d,!!o&&!!c&&!!t)},Ne=e=>function(t){const{useDispatch:s}=(0,n.useContext)(e),o=(0,u.n)("people",e),r=s(),l=(0,a.Jd)(),c=null===l||void 0===l?void 0:l.xuid,d=(0,n.useCallback)((async()=>{if(o&&c)try{await o.socialService.unshareRealNameWithUser(c,t),r(o.actions.unshareRealNameWithUser.success(t))}catch(e){const s=(0,p.g)(e);r(o.actions.unshareRealNameWithUser.error(o.actions.unshareRealNameWithUser.start(c,t),s))}}),[c,r,o,t]);return(0,i.I)(d,!!o&&!!c)},Xe=new o.Logger("useUserBlockState"),Be=e=>function(t){var s,o;const{useDispatch:r}=(0,n.useContext)(e),i=(0,u.n)("people",e),[a,{loading:l}]=Ze(t),c=r(),[d,g]=(0,n.useState)(null),[m,f]=(0,n.useState)(!1),S=(0,n.useCallback)((()=>{l||i&&t&&c(i.actions.getPerson.start(t,!0,["detail"]))}),[t,c,i,l]),h=(0,n.useCallback)((async e=>{var s;if(void 0===(null===a||void 0===a||null===(s=a.detail)||void 0===s?void 0:s.isBlocked)||!t||!i){var o;const e=[];return void 0===(null===a||void 0===a||null===(o=a.detail)||void 0===o?void 0:o.isBlocked)&&e.push("existing isBlocked state is undefined"),i||e.push("people plugin is not loaded"),t||e.push("no xuid is provided"),void Xe.info(`Cannot set blocked state: ${e.join(", ")}`)}g(e),f(!0);try{e?await i.privacyService.blockUser(t):await i.privacyService.unblockUser(t),c(i.actions.setUserBlockState.success(t,e))}catch(n){const s=(0,p.g)(n);c(i.actions.setUserBlockState.error(i.actions.setUserBlockState.start(t,e),s))}g(null),f(!1)}),[null===a||void 0===a||null===(s=a.detail)||void 0===s?void 0:s.isBlocked,t,i,c]),C=(0,n.useCallback)((()=>h(!0)),[h]),F=(0,n.useCallback)((()=>h(!1)),[h]),E=(0,n.useMemo)((()=>{var e;return m?(0,v.lceFetching)((0,v.lceContent)(d)):void 0===(null===a||void 0===a||null===(e=a.detail)||void 0===e?void 0:e.isBlocked)?v.LCE_NOT_REQUESTED:(0,v.lceContent)(a.detail.isBlocked)}),[m,d,null===a||void 0===a||null===(o=a.detail)||void 0===o?void 0:o.isBlocked]),k=(0,v.useLce)(E);return(0,n.useMemo)((()=>[...k,{blockUser:C,unblockUser:F,startRefreshUserBlockState:S}]),[k,C,F,S])},Qe=new o.Logger("useUserCloakedState"),Je=e=>function(t){const{useDispatch:s}=(0,n.useContext)(e),o=(0,u.n)("people",e),[r,{loading:i}]=Ze(t),a=s(),[l,c]=(0,n.useState)(null),[d,g]=(0,n.useState)(!1),m=(0,n.useCallback)((()=>{i||o&&t&&a(o.actions.getPerson.start(t,!0))}),[t,a,o,i]),f=(0,n.useCallback)((async e=>{if(void 0===(null===r||void 0===r?void 0:r.isCloaked)||!t||!o){const e=[];return void 0===(null===r||void 0===r?void 0:r.isCloaked)&&e.push("existing isCloaked state is undefined"),o||e.push("people plugin is not loaded"),t||e.push("no xuid is provided"),void Qe.info(`Cannot set cloak state: ${e.join(", ")}`)}c(e),g(!0);try{e?await o.presenceService.cloakUserPresence(t):await o.presenceService.uncloakUserPresence(t),a(o.actions.setCurrentUserCloakState.success(t,e))}catch(s){const t=(0,p.g)(s);a(o.actions.setCurrentUserCloakState.error(o.actions.setCurrentUserCloakState.start(e),t))}c(null),g(!1)}),[a,null===r||void 0===r?void 0:r.isCloaked,o,t]),S=(0,n.useCallback)((()=>f(!0)),[f]),h=(0,n.useCallback)((()=>f(!1)),[f]),C=(0,n.useMemo)((()=>d?(0,v.lceFetching)((0,v.lceContent)(l)):void 0===(null===r||void 0===r?void 0:r.isCloaked)?v.LCE_NOT_REQUESTED:(0,v.lceContent)(null===r||void 0===r?void 0:r.isCloaked)),[d,l,null===r||void 0===r?void 0:r.isCloaked]),F=(0,v.useLce)(C);return(0,n.useMemo)((()=>[...F,{cloakUser:S,uncloakUser:h,startRefreshCloak:m}]),[F,S,h,m])},$e=new o.Logger("useUserFavoriteState"),We=e=>function(t){const{useDispatch:s}=(0,n.useContext)(e),o=(0,u.n)("people",e),[r,{loading:i}]=Ze(t),l=s(),[c,d]=(0,n.useState)(null),[g,m]=(0,n.useState)(!1),f=(0,a.Jd)(),S=null===f||void 0===f?void 0:f.xuid,h=(0,n.useCallback)((()=>{i||o&&t&&l(o.actions.getPerson.start(t,!0))}),[t,l,o,i]),C=(0,n.useCallback)((async e=>{if(void 0===(null===r||void 0===r?void 0:r.isFavorite)||!o||!t||!S){const e=[];return void 0===(null===r||void 0===r?void 0:r.isFavorite)&&e.push("existing isFavorite state is undefined"),o||e.push("people plugin is not loaded"),t||e.push("no xuid is provided"),S||e.push("cannot fetch current user's xuid"),void $e.info(`Cannot set favorite state: ${e.join(", ")}`)}d(e),m(!0);try{e?(await o.socialService.favoriteUser(S,t),l(o.actions.favoriteUser.success(t))):(await o.socialService.unfavoriteUser(S,t),l(o.actions.unfavoriteUser.success(t)))}catch(s){const n=(0,p.g)(s);l(e?o.actions.favoriteUser.error(o.actions.favoriteUser.start(S,t),n):o.actions.unfavoriteUser.error(o.actions.unfavoriteUser.start(S,t),n))}d(null),m(!1)}),[null===r||void 0===r?void 0:r.isFavorite,t,S,o,l]),F=(0,n.useCallback)((()=>C(!0)),[C]),E=(0,n.useCallback)((()=>C(!1)),[C]),k=(0,n.useMemo)((()=>g?(0,v.lceFetching)((0,v.lceContent)(c)):void 0===(null===r||void 0===r?void 0:r.isFavorite)?v.LCE_NOT_REQUESTED:(0,v.lceContent)(r.isFavorite)),[g,c,null===r||void 0===r?void 0:r.isFavorite]),y=(0,v.useLce)(k);return(0,n.useMemo)((()=>[...y,{favoriteUser:F,unfavoriteUser:E,startRefreshUserFavoriteState:h}]),[y,F,E,h])},je=new o.Logger("useUserMuteState"),He=e=>function(t){var s,o;const{useDispatch:r}=(0,n.useContext)(e),i=(0,u.n)("people",e),[a,{loading:l}]=Ze(t),c=r(),[d,g]=(0,n.useState)(null),[m,f]=(0,n.useState)(!1),S=(0,n.useCallback)((()=>{l||i&&t&&c(i.actions.getPerson.start(t,!0,["detail"]))}),[t,c,i,l]),h=(0,n.useCallback)((async e=>{var s;if(void 0===(null===a||void 0===a||null===(s=a.detail)||void 0===s?void 0:s.isMuted)||!t||!i){var o;const e=[];return void 0===(null===a||void 0===a||null===(o=a.detail)||void 0===o?void 0:o.isMuted)&&e.push("existing isMuted state is undefined"),t||e.push("no xuid is provided"),i||e.push("people plugin is not loaded"),void je.info(`Cannot set mute state: ${e.join(", ")}`)}g(e),f(!0);try{e?await i.privacyService.muteUser(t):await i.privacyService.unmuteUser(t),c(i.actions.setUserMuteState.success(t,e))}catch(n){const s=(0,p.g)(n);c(i.actions.setUserMuteState.error(i.actions.setUserMuteState.start(t,e),s))}g(null),f(!1)}),[null===a||void 0===a||null===(s=a.detail)||void 0===s?void 0:s.isMuted,t,i,c]),C=(0,n.useCallback)((()=>h(!0)),[h]),F=(0,n.useCallback)((()=>h(!1)),[h]),E=(0,n.useMemo)((()=>{var e;return m?(0,v.lceFetching)((0,v.lceContent)(d)):void 0===(null===a||void 0===a||null===(e=a.detail)||void 0===e?void 0:e.isMuted)?v.LCE_NOT_REQUESTED:(0,v.lceContent)(a.detail.isMuted)}),[m,d,null===a||void 0===a||null===(o=a.detail)||void 0===o?void 0:o.isMuted]),k=(0,v.useLce)(E);return(0,n.useMemo)((()=>[...k,{muteUser:C,unmuteUser:F,startRefreshUserMuteState:S}]),[k,C,F,S])},ze=new o.Logger("useUserProfileSettings"),Ke=e=>function(t){const{useDispatch:s}=(0,n.useContext)(e),o=(0,u.n)("people",e),[r,{loading:i}]=Ze(t),a=s(),[l,c]=(0,n.useState)(null),[d,g]=(0,n.useState)(!1),m=(0,n.useCallback)((()=>{i||o&&t&&a(o.actions.getPerson.start(t,!0,["detail"]))}),[t,a,o,i]),f=(0,n.useCallback)((async e=>{if(null===r||void 0===r||!r.detail||!t||!o){const e=[];return null!==r&&void 0!==r&&r.detail||e.push("existing user profile settings are undefined"),t||e.push("no xuid is provided"),o||e.push("people plugin is not loaded"),void ze.info(`Cannot set user profile settings: ${e.join(", ")}`)}c(e),g(!0);try{await o.profileService.setProfileSettings(e),a(o.actions.updateProfileSettings.success(t,e)),a(o.actions.getPerson.start(t,!0))}catch(s){const t=(0,p.g)(s);a(o.actions.updateProfileSettings.error(o.actions.updateProfileSettings.start(e),t))}c(null),g(!1)}),[a,o,null===r||void 0===r?void 0:r.detail,t]),S=(0,n.useCallback)((e=>f(e)),[f]),h=(0,n.useMemo)((()=>d?(0,v.lceFetching)((0,v.lceContent)(l)):void 0===(null===r||void 0===r?void 0:r.detail)?v.LCE_NOT_REQUESTED:(0,v.lceContent)({Bio:r.detail.bio,Location:r.detail.location})),[d,l,null===r||void 0===r?void 0:r.detail]),C=(0,v.useLce)(h);return(0,n.useMemo)((()=>[...C,{onSetUserProfileSettings:S,startRefreshUserProfileSettings:m}]),[C,S,m])},Ve=e=>t=>{const{useSelector:s,useDispatch:o,useStore:r}=(0,n.useContext)(e),i=(0,u.n)("people",e),a=null===i||void 0===i?void 0:i.peopleSelectors,l=(0,n.useCallback)((e=>t&&a?a.getXuidForGamertagLCE(e,t):(0,v.lceNotRequested)()),[a,t]),c=(0,n.useMemo)((()=>t?null===i||void 0===i?void 0:i.actions.getXuidForGamertag.start(t):void 0),[i,t]);return(0,v.useLceWithConditions)((0,T.r)(i,l,c,void 0,{useSelector:s,useDispatch:o,useStore:r}),{notRequested:!t})};var Ye=s(20418);const{usePerson:Ze,usePeople:et,useXuidForGamertag:tt,useFriends:st,useOnlineFriends:ot,useOfflineFriends:nt,useSuggestedFriends:rt,useRemoveRecommendation:it,useUserCloakedState:at,useUserMuteState:lt,useUserBlockState:ut,useUserFavoriteState:ct,useFriendsOfUser:dt,useFollowingOfUser:vt,useFriendsWhoPlay:pt,useFollowers:gt,useFollowUser:mt,useRemoveFollower:ft,useRemoveFriend:St,useUnfollowUser:ht,useFindJoinableSessionFromXuid:Ct,useRecentlyPlayedWithUsers:Ft,useUserProfileSettings:Et,useProfileBadges:kt,useInviteUsersToGame:yt,useGenerateOpenEndedInviteLinkToken:Rt,useGameInviteFromLinkToken:Lt,useActiveLinkTokens:Ut,useRevokeOpenEndedInviteLinkToken:bt,useRedeemFriendInviteLink:xt,useFriendInviteLinkPreview:wt,useGetPerson:Tt,useGetReceivedFriendRequestsLCE:_t,useGetFriendRequestSummaryLCE:Pt,useGetSentFriendRequestsLCE:Dt,useAcceptFriendRequest:It,useDeclineFriendRequest:Gt,useCancelFriendRequest:Mt,useSendFriendRequest:qt,useBatchAcceptFriendRequests:Ot,useBatchCancelFriendRequests:At,useBatchDeclineFriendRequests:Nt,useIsUserInJoinableParty:Xt,useGroupFriendsAndPartiesLCE:Bt,useShareRealNameWithUser:Qt,useUnshareRealNameWithUser:Jt,useGenerateGamertags:$t,useReserveGamertag:Wt,useCommitNewGamertag:jt,useGetCanUserChangeGamertagForFree:Ht}=(zt=Ye.Ie,{usePerson:fe(zt),usePeople:I(zt),useXuidForGamertag:Ve(zt),useFriends:Q(zt),useOnlineFriends:Ce(zt),useOfflineFriends:he(zt),useSuggestedFriends:Oe(zt),useRemoveRecommendation:we(zt),useUserCloakedState:Je(zt),useUserMuteState:He(zt),useUserBlockState:Be(zt),useUserFavoriteState:We(zt),useFriendsOfUser:J(zt),useFollowingOfUser:G(zt),useFriendsWhoPlay:$(zt),useFollowers:P(zt),useFindJoinableSessionFromXuid:w(zt),useRecentlyPlayedWithUsers:ke(zt),useUserProfileSettings:Ke(zt),useProfileBadges:Fe(zt),useInviteUsersToGame:me(zt),useGenerateOpenEndedInviteLinkToken:Y(zt),useGameInviteFromLinkToken:z(zt),useActiveLinkTokens:m(zt),useRevokeOpenEndedInviteLinkToken:Ie(zt),useRedeemFriendInviteLink:Re(zt),useFriendInviteLinkPreview:q(zt),useGetPerson:se(zt),useGetReceivedFriendRequestsLCE:oe(zt),useGetFriendRequestSummaryLCE:te(zt),useGetSentFriendRequestsLCE:ne(zt),useAcceptFriendRequest:d(zt),useDeclineFriendRequest:U(zt),useCancelFriendRequest:y(zt),useSendFriendRequest:Me(zt),useIsUserInJoinableParty:Se(zt),useGroupFriendsAndPartiesLCE:de(zt),useUnfollowUser:Ae(zt),useFollowUser:M(zt),useRemoveFriend:xe(zt),useRemoveFollower:Ue(zt),useBatchAcceptFriendRequests:S(zt),useBatchCancelFriendRequests:C(zt),useBatchDeclineFriendRequests:E(zt),useShareRealNameWithUser:qe(zt),useUnshareRealNameWithUser:Ne(zt),useGenerateGamertags:K(zt),useReserveGamertag:Pe(zt),useCommitNewGamertag:R(zt),useGetCanUserChangeGamertagForFree:ee(zt)});var zt},84777:(e,t,s)=>{var o;s.d(t,{p:()=>o}),function(e){e[e.Send=0]="Send",e[e.Accept=1]="Accept"}(o||(o={}))},13312:(e,t,s)=>{s.d(t,{R:()=>n});s(10568),s(81045),s(5350),s(73118),s(90374),s(72252),s(38124),s(70889),s(98788),s(46826),s(65949),s(9402),s(84035),s(14419),s(20629),s(90029),s(21019),s(65478),s(55976),s(47010);var o=s(14041);const n=e=>(0,o.useMemo)((()=>{const t=new Set;return(null!==e&&void 0!==e?e:[]).forEach((e=>{var s,o;(null!==(s=null===(o=e.multiplayerSummary)||void 0===o?void 0:o.joinableActivities)&&void 0!==s?s:[]).forEach((e=>{t.add(e.titleId.toString())}))})),Array.from(t)}),[e])},49578:(e,t,s)=>{s.d(t,{J:()=>m});var o=s(41506),n=s.n(o),r=(s(69375),s(81045),s(5350),s(75604),s(41532),s(32950),s(73599),s(64770),s(62080),s(97012),s(31274),s(29548),s(47342),s(14825),s(92467),s(67497),s(88236),s(47010),s(57361)),i=s(14041),a=s(13312),l=s(87309),u=s(99412),c=s(9718),d=s(91410),v=s(15387),p=s(24013),g=s(79094);const m=e=>{const[t,s]=(0,d.OC)(),o=(0,v.G_)(l.H.IsTakehomeUser),m=(0,a.R)(t),[f,S]=(0,g.$)(m),h=(0,i.useMemo)((()=>{const e=[];for(const t in f){const s=f[t];s&&e.push(s)}return e}),[f]),[,C]=(0,p.I)(h);return(0,r.useLce)((0,i.useMemo)((()=>{const t=(0,r.lceMerge)(s,(0,r.lceMerge)(S,C,{onlyRequireOneNotRequested:!e}),{onlyRequireOneNotRequested:!0});return(0,r.lceTransform)(t,(t=>{let[s,[r,i]]=t;const a=[],l=[];if(!s||!r||!e&&!i)return{friendsInJoinableSessions:a,activeFriends:l};const d=new Map;null===i||void 0===i||i.forEach((e=>{d.set(e.productId,e)}));for(const p of s){const{productId:t,xboxTitleId:s}=(0,c.a)(p,r),i=t&&d.get(t);if(t&&s&&i&&(0,u.VZ)(i,o)){if(e&&e!==s)continue;a.push(n()(n()({},p),{},{productId:t,xboxTitleId:s}))}else{var v;if(e&&e!==(null===(v=p.presence)||void 0===v?void 0:v.presenceTitleId))continue;l.push(p)}}return{friendsInJoinableSessions:a,activeFriends:l}}))}),[e,s,C,S,o]))}},14154:(e,t,s)=>{s.d(t,{X:()=>n});var o=s(14041);function n(e){const t=(0,o.useRef)(!1),s=(0,o.useRef)(null);return t.current||(s.current=e(),t.current=!0),s}},24013:(e,t,s)=>{s.d(t,{H:()=>v,I:()=>d});var o=s(41506),n=s.n(o),r=(s(81045),s(42042),s(30163),s(84915),s(47010),s(57361)),i=s(14041),a=s(79094),l=s(45658),u=s(83659),c=s(56136);function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c._.Basic;const s=(0,i.useCallback)((t=>e.map((e=>(0,u.lL)(t,e)))),[e]);return(0,r.useMultipleReduxLces)(s,(0,l.R)(e,t,"productId"),{skipErrors:!0},(e=>{if((0,r.isExpiredOrNotFetched)(e))return!0;if(t===c._.Basic)return!1;if(!(0,r.isContent)(e))return!1;return!e.data.every((e=>t===(null===e||void 0===e?void 0:e.detailLevel)))}))}function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c._.Basic;const[s,o]=(0,a.$)(e,t),l=d((0,i.useMemo)((()=>s?Object.values(s).filter((e=>!!e)):[]),[s]),t),u=(0,i.useMemo)((()=>[void 0,n()(n()({},(0,r.lceNotRequested)()),{},{loading:!1})]),[]);return s?l:(0,r.isError)(o)||o.loading?[void 0,o]:u}},38132:(e,t,s)=>{s.d(t,{I:()=>u});s(47010);var o=s(66957),n=s(7463),r=s(14041),i=s(14154);const a=!1;function l(e,t){const s=(0,r.useRef)(),a=(0,r.useRef)();return e===s.current&&a.current||(s.current=e,a.current=e()),function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=(0,i.X)((()=>new o.Logger("usePromise"))),[a,l]=(0,r.useState)(),u=(0,n.useIsMountedRef)(),c=(0,r.useRef)();return(0,r.useEffect)((()=>{t||c.current!==e&&(c.current=e,e.then((function(t){u.current&&c.current===e&&l((()=>t))})).catch((t=>{var o,n,r;c.current!==e?null===(n=s.current)||void 0===n||n.warn(`Unhandled exception from a previous Promise: ${t.message}`,t):null===(r=s.current)||void 0===r||r.error(`Unhandled Promise exception: ${t.message}`,t),null===(o=s.current)||void 0===o||o.debug("Promises should have their rejections handled prior to being passed into 'usePromise'")})))}),[u,s,e,t]),a}(a.current,t)}function u(e,t){if(!a)return l(e,t)}},1033:(e,t,s)=>{var o;s.d(t,{H:()=>o}),function(e){e.Online="online",e.Offline="offline"}(o||(o={}))},9718:(e,t,s)=>{s.d(t,{a:()=>o});s(10568),s(81045),s(30163),s(45950);const o=(e,t)=>{var s,o;if(!t)return{productId:null,xboxTitleId:null};const n=(null!==(s=null===(o=e.multiplayerSummary)||void 0===o||null===(o=o.joinableActivities)||void 0===o?void 0:o.filter((t=>{switch(t.joinRestriction){case"Public":return!0;case"Followed":return e.isFriend;default:return!1}})))&&void 0!==s?s:[]).find((e=>null!=t[e.titleId.toString()]));return{productId:n?t[n.titleId.toString()]:null,xboxTitleId:n?n.titleId.toString():null}}},50906:(e,t,s)=>{s.d(t,{x:()=>n});var o=s(1033);const n=e=>{var t,s;if(null!==e&&void 0!==e&&null!==(t=e.multiplayerSummary)&&void 0!==t&&t.party&&(null===e||void 0===e||null===(s=e.presence)||void 0===s?void 0:s.presenceState)===o.H.Online){return e.multiplayerSummary.party.sessionRef.name}}}}]);